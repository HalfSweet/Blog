var xe=Object.defineProperty;var Fe=(c,h,e)=>h in c?xe(c,h,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[h]=e;var b=(c,h,e)=>(Fe(c,typeof h!="symbol"?h+"":h,e),e),ne=(c,h,e)=>{if(!h.has(c))throw TypeError("Cannot "+e)};var t=(c,h,e)=>(ne(c,h,"read from private field"),e?e.call(c):h.get(c)),a=(c,h,e)=>{if(h.has(c))throw TypeError("Cannot add the same private member more than once");h instanceof WeakSet?h.add(c):h.set(c,e)},d=(c,h,e,s)=>(ne(c,h,"write to private field"),s?s.call(c,e):h.set(c,e),e);var o=(c,h,e)=>(ne(c,h,"access private method"),e);import{aF as Oe,s as pe,P as De,t as oe,p as ae,k as je,L as ye,l as Be,i as Ne}from"./vidstack-Ds_q5BGO-BmIdNEue.js";import{T as C,L as x,Q as be}from"./vidstack-player-CGtoCiBG.js";import{a as Ue}from"./vidstack-DXXgp8ue-BEqIG_iI.js";import{R as _e}from"./vidstack-DSYpsFWk-CqqLDmWv.js";import{E as We}from"./vidstack-BePVaxm4-BQgQuoAH.js";import{resolveVimeoVideoId as Ye,getVimeoVideoInfo as ze}from"./vidstack-krOAtKMi-C3UUF7YD.js";import"./app-BvW9zp2N.js";const Ge=["bufferend","bufferstart","durationchange","ended","enterpictureinpicture","error","fullscreenchange","leavepictureinpicture","loaded","playProgress","loadProgress","pause","play","playbackratechange","qualitychange","seeked","seeking","timeupdate","volumechange","waiting"];var n,y,k,w,g,V,v,$,F,P,m,E,O,ke,D,ve,j,me,B,we,T,N,Pe,U,Te,_,Ce,I,re,W,ge,Y,$e,z,Ee,G,Ve,H,Ie,R,he,J,Re,K,Ae,X,Me,A,ce,Z,Se,M,le,ee,qe,S,ue,te,Le,se,Qe,l,u,q,de,L,fe;class it extends We{constructor(e,s){super(e);a(this,O);a(this,D);a(this,j);a(this,B);a(this,N);a(this,U);a(this,_);a(this,I);a(this,W);a(this,Y);a(this,z);a(this,G);a(this,H);a(this,R);a(this,J);a(this,K);a(this,X);a(this,A);a(this,Z);a(this,M);a(this,ee);a(this,S);a(this,te);a(this,se);a(this,l);a(this,q);a(this,L);b(this,"$$PROVIDER_TYPE","VIMEO");b(this,"scope",Oe());b(this,"fullscreen");a(this,n,void 0);a(this,y,pe(""));a(this,k,pe(!1));a(this,w,null);a(this,g,null);a(this,V,!1);a(this,v,new C(0,0));a(this,$,new _e(o(this,B,we).bind(this)));a(this,F,null);a(this,P,null);a(this,m,new Map);a(this,E,null);b(this,"cookies",!1);b(this,"title",!0);b(this,"byline",!0);b(this,"portrait",!0);b(this,"color","00ADEF");a(this,T,!1);d(this,n,s);const i=this;this.fullscreen={get active(){return t(i,V)},supported:!0,enter:()=>o(this,l,u).call(this,"requestFullscreen"),exit:()=>o(this,l,u).call(this,"exitFullscreen")}}get type(){return"vimeo"}get currentSrc(){return t(this,g)}get videoId(){return t(this,y).call(this)}get hash(){return t(this,w)}get isPro(){return t(this,k).call(this)}preconnect(){De(this.getOrigin())}setup(){super.setup(),oe(o(this,O,ke).bind(this)),oe(o(this,D,ve).bind(this)),oe(o(this,j,me).bind(this)),t(this,n).notify("provider-setup",this)}destroy(){o(this,q,de).call(this),this.fullscreen=void 0;const e="provider destroyed";for(const s of t(this,m).values())for(const{reject:i}of s)i(e);t(this,m).clear(),o(this,l,u).call(this,"destroy")}async play(){return o(this,l,u).call(this,"play")}async pause(){return o(this,l,u).call(this,"pause")}setMuted(e){o(this,l,u).call(this,"setMuted",e)}setCurrentTime(e){o(this,l,u).call(this,"seekTo",e),t(this,n).notify("seeking",e)}setVolume(e){o(this,l,u).call(this,"setVolume",e),o(this,l,u).call(this,"setMuted",ae(t(this,n).$state.muted))}setPlaybackRate(e){o(this,l,u).call(this,"setPlaybackRate",e)}async loadSource(e){if(!je(e.src)){d(this,g,null),d(this,w,null),t(this,y).set("");return}const{videoId:s,hash:i}=Ye(e.src);t(this,y).set(s??""),d(this,w,i??null),d(this,g,e)}getOrigin(){return"https://player.vimeo.com"}buildParams(){const{keyDisabled:e}=t(this,n).$props,{playsInline:s,nativeControls:i}=t(this,n).$state,r=i();return{title:this.title,byline:this.byline,color:this.color,portrait:this.portrait,controls:r,h:this.hash,keyboard:r&&!e(),transparent:!0,playsinline:s(),dnt:!this.cookies}}onMessage(e,s){e.event?o(this,te,Le).call(this,e.event,e.data,s):e.method&&o(this,W,ge).call(this,e.method,e.value,s)}onLoad(){}}n=new WeakMap,y=new WeakMap,k=new WeakMap,w=new WeakMap,g=new WeakMap,V=new WeakMap,v=new WeakMap,$=new WeakMap,F=new WeakMap,P=new WeakMap,m=new WeakMap,E=new WeakMap,O=new WeakSet,ke=function(){o(this,q,de).call(this);const e=t(this,y).call(this);if(!e){this.src.set("");return}this.src.set(`${this.getOrigin()}/video/${e}`),t(this,n).notify("load-start")},D=new WeakSet,ve=function(){const e=t(this,y).call(this);if(!e)return;const s=ye(),i=new AbortController;return d(this,E,s),ze(e,i,t(this,w)).then(r=>{s.resolve(r)}).catch(r=>{s.reject()}),()=>{s.reject(),i.abort()}},j=new WeakSet,me=function(){const e=t(this,k).call(this),{$state:s,qualities:i}=t(this,n);if(s.canSetPlaybackRate.set(e),i[x.setReadonly](!e),e)return Be(i,"change",()=>{var f;if(i.auto)return;const r=(f=i.selected)==null?void 0:f.id;r&&o(this,l,u).call(this,"setQuality",r)})},B=new WeakSet,we=function(){o(this,l,u).call(this,"getCurrentTime")},T=new WeakMap,N=new WeakSet,Pe=function(e,s){if(t(this,T)&&e===0)return;const{realCurrentTime:i,paused:r,bufferedEnd:f,seekableEnd:p,live:Q}=t(this,n).$state;if(i()===e)return;const ie=i();t(this,n).notify("time-change",e,s),Math.abs(ie-e)>1.5&&(t(this,n).notify("seeking",e,s),!r()&&f()<e&&t(this,n).notify("waiting",void 0,s)),!Q()&&p()-e<.01&&(t(this,n).notify("end",void 0,s),d(this,T,!0),setTimeout(()=>{d(this,T,!1)},500))},U=new WeakSet,Te=function(e,s){t(this,n).notify("seeked",e,s)},_=new WeakSet,Ce=function(e){var i;const s=t(this,y).call(this);(i=t(this,E))==null||i.promise.then(r=>{if(!r)return;const{title:f,poster:p,duration:Q,pro:ie}=r;t(this,k).set(ie),t(this,n).notify("title-change",f,e),t(this,n).notify("poster-change",p,e),t(this,n).notify("duration-change",Q,e),o(this,I,re).call(this,Q,e)}).catch(()=>{s===t(this,y).call(this)&&(o(this,l,u).call(this,"getVideoTitle"),o(this,l,u).call(this,"getDuration"))})},I=new WeakSet,re=function(e,s){const{nativeControls:i}=t(this,n).$state,r=i();d(this,v,new C(0,e));const f={buffered:new C(0,0),seekable:t(this,v),duration:e};t(this,n).delegate.ready(f,s),r||o(this,l,u).call(this,"_hideOverlay"),o(this,l,u).call(this,"getQualities"),o(this,l,u).call(this,"getChapters")},W=new WeakSet,ge=function(e,s,i){var r;switch(e){case"getVideoTitle":const f=s;t(this,n).notify("title-change",f,i);break;case"getDuration":const p=s;t(this,n).$state.canPlay()?t(this,n).notify("duration-change",p,i):o(this,I,re).call(this,p,i);break;case"getCurrentTime":o(this,N,Pe).call(this,s,i);break;case"getBuffered":Ne(s)&&s.length&&o(this,R,he).call(this,s[s.length-1][1],i);break;case"setMuted":o(this,A,ce).call(this,ae(t(this,n).$state.volume),s,i);break;case"getChapters":o(this,Z,Se).call(this,s);break;case"getQualities":o(this,ee,qe).call(this,s,i);break}(r=o(this,L,fe).call(this,e))==null||r.resolve()},Y=new WeakSet,$e=function(){for(const e of Ge)o(this,l,u).call(this,"addEventListener",e)},z=new WeakSet,Ee=function(e){t(this,$).stop(),t(this,n).notify("pause",void 0,e)},G=new WeakSet,Ve=function(e){t(this,$).start(),t(this,n).notify("play",void 0,e)},H=new WeakSet,Ie=function(e){const{paused:s}=t(this,n).$state;!s()&&!t(this,T)&&t(this,n).notify("playing",void 0,e)},R=new WeakSet,he=function(e,s){const i={buffered:new C(0,e),seekable:t(this,v)};t(this,n).notify("progress",i,s)},J=new WeakSet,Re=function(e){t(this,n).notify("waiting",void 0,e)},K=new WeakSet,Ae=function(e){const{paused:s}=t(this,n).$state;s()||t(this,n).notify("playing",void 0,e)},X=new WeakSet,Me=function(e){const{paused:s}=t(this,n).$state;s()&&t(this,n).notify("play",void 0,e),t(this,n).notify("waiting",void 0,e)},A=new WeakSet,ce=function(e,s,i){const r={volume:e,muted:s};t(this,n).notify("volume-change",r,i)},Z=new WeakSet,Se=function(e){if(o(this,M,le).call(this),!e.length)return;const s=new Ue({kind:"chapters",default:!0}),{seekableEnd:i}=t(this,n).$state;for(let r=0;r<e.length;r++){const f=e[r],p=e[r+1];s.addCue(new window.VTTCue(f.startTime,(p==null?void 0:p.startTime)??i(),f.title))}d(this,P,s),t(this,n).textTracks.add(s)},M=new WeakSet,le=function(){t(this,P)&&(t(this,n).textTracks.remove(t(this,P)),d(this,P,null))},ee=new WeakSet,qe=function(e,s){t(this,n).qualities[be.enableAuto]=e.some(i=>i.id==="auto")?()=>o(this,l,u).call(this,"setQuality","auto"):void 0;for(const i of e){if(i.id==="auto")continue;const r=+i.id.slice(0,-1);isNaN(r)||t(this,n).qualities[x.add]({id:i.id,width:r*(16/9),height:r,codec:"avc1,h.264",bitrate:-1},s)}o(this,S,ue).call(this,e.find(i=>i.active),s)},S=new WeakSet,ue=function({id:e}={},s){if(!e)return;const i=e==="auto",r=t(this,n).qualities.getById(e);i?(t(this,n).qualities[be.setAuto](i,s),t(this,n).qualities[x.select](void 0,!0,s)):t(this,n).qualities[x.select](r??void 0,!0,s)},te=new WeakSet,Le=function(e,s,i){switch(e){case"ready":o(this,Y,$e).call(this);break;case"loaded":o(this,_,Ce).call(this,i);break;case"play":o(this,G,Ve).call(this,i);break;case"playProgress":o(this,H,Ie).call(this,i);break;case"pause":o(this,z,Ee).call(this,i);break;case"loadProgress":o(this,R,he).call(this,s.seconds,i);break;case"waiting":o(this,X,Me).call(this,i);break;case"bufferstart":o(this,J,Re).call(this,i);break;case"bufferend":o(this,K,Ae).call(this,i);break;case"volumechange":o(this,A,ce).call(this,s.volume,ae(t(this,n).$state.muted),i);break;case"durationchange":d(this,v,new C(0,s.duration)),t(this,n).notify("duration-change",s.duration,i);break;case"playbackratechange":t(this,n).notify("rate-change",s.playbackRate,i);break;case"qualitychange":o(this,S,ue).call(this,s,i);break;case"fullscreenchange":d(this,V,s.fullscreen),t(this,n).notify("fullscreen-change",s.fullscreen,i);break;case"enterpictureinpicture":t(this,n).notify("picture-in-picture-change",!0,i);break;case"leavepictureinpicture":t(this,n).notify("picture-in-picture-change",!1,i);break;case"ended":t(this,n).notify("end",void 0,i);break;case"error":o(this,se,Qe).call(this,s,i);break;case"seek":case"seeked":o(this,U,Te).call(this,s.seconds,i);break}},se=new WeakSet,Qe=function(e,s){var f;const{message:i,method:r}=e;r==="setPlaybackRate"&&t(this,k).set(!1),r&&((f=o(this,L,fe).call(this,r))==null||f.reject(i))},l=new WeakSet,u=async function(e,s){let i=ye(),r=t(this,m).get(e);return r||t(this,m).set(e,r=[]),r.push(i),this.postMessage({method:e,value:s}),i.promise},q=new WeakSet,de=function(){t(this,$).stop(),d(this,v,new C(0,0)),d(this,E,null),d(this,F,null),t(this,k).set(!1),o(this,M,le).call(this)},L=new WeakSet,fe=function(e){var s;return(s=t(this,m).get(e))==null?void 0:s.shift()};export{it as VimeoProvider};
